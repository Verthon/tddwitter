import 'module';
/*#__PURE__*/ import.meta.url;
import { openBrowser } from "@rsdoctor/sdk";
import { makeRulesSerializable } from "@rsdoctor/core/plugins";
import { SDK } from "@rsdoctor/types";
import { chalk } from "@rsdoctor/utils/logger";
import { cloneDeep } from "lodash-es";
import path from "path";
function processCompilerConfig(config) {
    var _rest_module, _rest_module1;
    const { plugins, infrastructureLogging, ...rest } = config;
    const _rest = cloneDeep(rest);
    if (null == (_rest_module = _rest.module) ? void 0 : _rest_module.defaultRules) makeRulesSerializable(_rest.module.defaultRules);
    if (null == (_rest_module1 = _rest.module) ? void 0 : _rest_module1.rules) makeRulesSerializable(_rest.module.rules);
    return {
        ..._rest,
        plugins: plugins.map((e)=>null == e ? void 0 : e.constructor.name)
    };
}
function handleBriefModeReport(sdk, options, disableClientServer) {
    if (!disableClientServer && options.output.mode === SDK.IMode[SDK.IMode.brief]) {
        const htmlOptions = 'htmlOptions' in options.output.options && options.output.options.htmlOptions || void 0;
        const outputFilePath = path.resolve(sdk.outputDir, (null == htmlOptions ? void 0 : htmlOptions.reportHtmlName) || 'rsdoctor-report.html');
        console.log(`${chalk.green('[RSDOCTOR] generated brief report')}: ${outputFilePath}`);
        openBrowser(`file:///${outputFilePath}`);
    }
}
export { handleBriefModeReport, processCompilerConfig };
