import 'module';
/*#__PURE__*/ import.meta.url;
import { Asset, Chunk, EntryPoint } from "@rsdoctor/graph";
function patchNativeChunkGraph(cg, rawChunkGraph) {
    const { chunks: rawChunks, entrypoints: rawEntrypoints } = rawChunkGraph;
    const chunks = rawChunks.map((chunk)=>new Chunk(chunk.ukey.toString(), chunk.name, 0, chunk.initial, chunk.entry));
    cg.setChunks(chunks);
    const entrypoints = rawEntrypoints.map((entrypoint)=>{
        const res = new EntryPoint(entrypoint.name);
        res.setId(entrypoint.ukey);
        return res;
    });
    cg.setEntrypoints(entrypoints);
    for (const rawChunk of rawChunks){
        const chunk = cg.getChunkById(rawChunk.ukey.toString());
        chunk.setDependencies(rawChunk.dependencies.map((ukey)=>cg.getChunkById(ukey.toString())));
        chunk.setImported(rawChunk.imported.map((ukey)=>cg.getChunkById(ukey.toString())));
    }
    for (const rawEntrypoint of rawEntrypoints){
        const entrypoint = cg.getEntryPointById(rawEntrypoint.ukey);
        entrypoint.setChunks(rawEntrypoint.chunks.map((ukey)=>cg.getChunkById(ukey.toString())));
    }
}
function patchNativeAssets(cg, rawAssetPatch) {
    const { assets: rawAssets, chunkAssets: rawChunkAssets, entrypointAssets: rawEntrypointAssets } = rawAssetPatch;
    const assets = rawAssets.map((asset)=>{
        const res = new Asset(asset.path, asset.size, [], '');
        res.setId(asset.ukey);
        return res;
    });
    cg.setAssets(assets);
    for (const rawAsset of rawAssets){
        const asset = cg.getAssetById(rawAsset.ukey);
        asset.setChunks(rawAsset.chunks.map((ukey)=>cg.getChunkById(ukey.toString())));
    }
    for (const rawChunkAsset of rawChunkAssets){
        const chunk = cg.getChunkById(rawChunkAsset.chunk.toString());
        chunk.setAssets(rawChunkAsset.assets.map((ukey)=>cg.getAssetById(ukey)));
    }
    for (const rawEntrypointAsset of rawEntrypointAssets){
        const entrypoint = cg.getEntryPointById(rawEntrypointAsset.entrypoint);
        entrypoint.setAssets(rawEntrypointAsset.assets.map((ukey)=>cg.getAssetById(ukey)));
    }
}
export { patchNativeAssets, patchNativeChunkGraph };
